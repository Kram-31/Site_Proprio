---
import Layout from '../layouts/Layout.astro';
import SectionTitle from '../components/SectionTitle.astro';
import Layout from '../layouts/Layout.astro';
import SectionTitle from '../components/SectionTitle.astro';
import TattooCard from '../components/TattooCard.astro';
import { supabase } from '../lib/supabase';
import { Image } from 'astro:assets'; // Keep for static assets if needed

// Fetch latest tattoos
const { data: latestTattoos } = await supabase
  .from('tattoos')
  .select('*')
  .eq('status', 'done')
  .order('published_date', { ascending: false })
  .limit(3);

const displayTattoos = latestTattoos || [];

import tatoo1 from '../assets/tattoos/tatoo1.png';
import heroBg from '../assets/hero-bg.jpg';
import tatoo3 from '../assets/tattoos/tatoo3.png';
import tatoo4 from '../assets/tattoos/tatoo4.png';
import tatoo5 from '../assets/tattoos/tatoo5.png';
---

<Layout title="L'Art Mûri | Tatoueur">
	<!-- HERO SECTION -->
	<section id="hero" class="relative min-h-screen flex items-center justify-center overflow-hidden pt-20">
		<div class="absolute inset-0 z-0 opacity-40">
			<div class="h-full w-full relative overflow-hidden">
                <div class="parallax-bg w-full h-[120%] -translate-y-[10%] relative" data-speed="-0.5">
                    <Image src={heroBg} alt="L'Art Mûri Background" class="w-full h-full object-cover" />
                </div>
            </div>
		</div>
        
        <div class="absolute inset-0 bg-gradient-to-b from-black/80 via-transparent to-[#050505] z-10"></div>

		<div class="relative z-20 text-center flex flex-col items-center">
            <span class="text-[var(--color-primary)] font-bold tracking-[0.3em] uppercase mb-4 animate-[fadeIn_1s_ease-out]">
                Histoires encrées
            </span>
			<h1 class="text-5xl md:text-[9rem] font-heading font-bold uppercase leading-tight mix-blend-overlay text-white opacity-90 animate-[scaleIn_1.5s_ease-out]">
				L'Art <span class="text-outline">Mûri</span>
			</h1>
            <a href="/booking" class="group relative mt-12 px-10 py-4 overflow-hidden border border-white/20 bg-white/5 text-white font-heading font-bold uppercase tracking-widest hover:border-[var(--color-primary)] transition-all duration-300">
                <span class="relative z-10 group-hover:text-black transition-colors duration-300">Réserver une Séance</span>
                <div class="absolute inset-0 bg-white transform -translate-x-full group-hover:translate-x-0 transition-transform duration-300 ease-out z-0"></div>
            </a>
		</div>

        <!-- Scroll Indicator -->
        <div class="absolute bottom-10 left-1/2 -translate-x-1/2 z-20 animate-bounce">
            <svg class="w-6 h-6 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
        </div>
	</section>

	<!-- INTRO SECTION -->
	<section class="py-24 px-4 relative bg-[#050505]">
        <div class="max-w-6xl mx-auto grid md:grid-cols-2 gap-16 items-center">
            <div class="relative">
                 <!-- Aesthetic image collage placeholder -->
                 <div class="w-full aspect-[3/4] bg-gray-900 overflow-hidden relative group img-reveal-container rounded-sm">
                    <Image src={tatoo5} alt="Artist Work" class="object-cover w-full h-full" />
                 </div>
                 <div class="absolute -bottom-10 -right-10 w-2/3 aspect-square bg-[var(--color-primary)]/20 z-[-1]"></div>
            </div>
            
            <div>
                <SectionTitle title="Mickaël Kalfayan" subtitle="L'Artiste" align="left" />
                
                
                <p class="text-gray-400 text-lg leading-relaxed mb-8">
                    Je ne suis pas juste un tatoueur, je suis un narrateur. Chaque pièce est conçue pour raconter une partie de votre histoire. Spécialisé dans le Blackwork et le Néotraditionnel, je transforme vos idées en art éternel.
                </p>

                <div class="mb-8 p-6 bg-white/5 border border-white/10 rounded-sm">
                    <p class="font-heading font-bold uppercase tracking-widest text-sm text-[var(--color-primary)] mb-2">Le Studio</p>
                    <p class="text-white text-lg font-bold">L'Art Mûrit</p>
                    <p class="text-gray-400">67 rue Victor Hugo, 09500 Mirepoix</p>
                </div>

                <a href="/gallery" class="inline-block border-b-2 border-[var(--color-primary)] pb-1 text-xl font-heading uppercase tracking-widest hover:text-[var(--color-primary)] transition-colors">
                    En savoir plus
                </a>
            </div>
        </div>
	</section>

	<!-- STYLES SECTION -->
	<section class="py-24 bg-black relative overflow-hidden">
         <div class="absolute top-0 right-0 w-full h-full opacity-10 pointer-events-none">
            <span class="absolute top-10 right-[-10%] text-[15rem] font-heading font-bold uppercase text-outline rotate-12">Studio</span>
         </div>

         <div class="max-w-7xl mx-auto grid md:grid-cols-2 gap-12 items-center px-4">
            <div>
                <SectionTitle title="Le Studio" subtitle="Expertise" align="left" />
                
                <ul class="flex flex-col gap-4 mt-8 items-start">
                    {['Style Japonais', 'Géométrique', 'Blackwork', 'Dotwork', 'Réalisme'].map((style, index) => (
                        <li class={`
                            font-heading font-bold uppercase text-2xl md:text-4xl px-6 py-2 transform transition-transform hover:scale-105 cursor-default
                            ${index === 2 
                                ? 'bg-[var(--color-primary)] text-white -rotate-2 shadow-[0_0_30px_rgba(212,163,115,0.4)]' 
                                : 'bg-white text-black ' + (index % 2 === 0 ? 'rotate-1' : '-rotate-1')
                            }
                        `}>
                            {style}
                        </li>
                    ))}
                </ul>
            </div>
            <div class="relative h-[600px] hidden md:block overflow-hidden group img-reveal-container rounded-sm">
                 <Image src={tatoo3} class="absolute top-0 left-0 w-full h-full object-cover" alt="Studio Vibe" />
            </div>
         </div>
	</section>

	<!-- GALLERY PREVIEW -->
	<section class="py-24 px-4 bg-[#050505]">
        <SectionTitle title="La Galerie" subtitle="Dernières Réalisations" />
        
        <div class="max-w-7xl mx-auto grid md:grid-cols-3 gap-8 mt-16">
            {displayTattoos.map(tattoo => (
                <TattooCard 
                    title={tattoo.title}
                    image={tattoo.image_url}
                    tags={tattoo.tags}
                    id={tattoo.id}
                />
            ))}
            <!-- Fallback if no tattoos -->
            {displayTattoos.length === 0 && (
                <div class="col-span-3 text-center py-20 border border-white/10 border-dashed">
                    <p class="text-gray-500 uppercase font-heading text-xl">Aucun tatouage publié pour le moment.</p>
                </div>
            )}
        </div>
        
        <div class="text-center mt-16">
             <a href="/gallery" class="px-8 py-3 bg-transparent border border-white text-white font-heading font-bold uppercase tracking-wider hover:bg-white hover:text-black transition-colors">
                Voir tout le portfolio
            </a>
        </div>
	</section>
</Layout>

<script>
    // Parallax Effect
    const parallaxBgs = document.querySelectorAll('.parallax-bg');
    
    window.addEventListener('scroll', () => {
        const scrolled = window.scrollY;
        
        parallaxBgs.forEach((bg) => {
            const speed = parseFloat((bg as HTMLElement).dataset.speed || '0.2');
            (bg as HTMLElement).style.transform = `translateY(${scrolled * speed}px)`;
        });
    });

    // Intersection Observer for Fade In elements (if any added later)
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('opacity-100', 'translate-y-0');
            }
        });
    });
</script>
